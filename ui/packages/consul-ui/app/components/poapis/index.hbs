{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: MPL-2.0
}}

<div {{did-insert this.handleWillRender}} class='po-container'>

  <span class='display-flex-container'>
    <h1 class='api-insights-title'>API Insights</h1>
    <h5 class='powered-by'>
      Powered by
      <a class='powered-by-link' href='https://protectonce.com/' target='_blank'>
        <img
          src='/ui/assets/images/poLogoFull.svg'
          class='protectonce-logo'
          alt='protectonce-logo'
        />
      </a>
    </h5>
  </span>

  {{#if loggedIn}}
    {{#if isLoaded}}
      <Hds::Table>
        <:head as |H|>
          <H.Tr>
            <H.Th>Service</H.Th>
            <H.Th>API Type</H.Th>
            <H.Th>Host</H.Th>
            <H.Th>Path</H.Th>
            <H.Th>Method</H.Th>
            <H.Th>Risk</H.Th>
            <H.Th>Issues</H.Th>
            <H.Th>PII</H.Th>
            <H.Th>Auth Type</H.Th>
            <H.Th>Internet Facing</H.Th>
            <H.Th>Traffic</H.Th>
            <H.Th>Drifted</H.Th>
          </H.Tr>
        </:head>
        <:body as |B|>
          {{#each apisDataFin as |item|}}
            <B.Tr {{action 'showDetails' item}}>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Service'>
                  <span {{tooltip item.Service}}>
                    {{item.Service}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell-child-API'>
                {{! <div class='po-table-cell-child-API'> }}
                <img {{tooltip item.APIType}} src={{item.APIImage}} class='api-type-image' />
                {{! </div> }}
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Host'>
                  <span {{tooltip item.Host}}>
                    {{item.Host}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child' {{tooltip item.Path}}>
                  {{item.Path}}
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Method'>
                  <span {{tooltip item.Method}}>
                    {{item.Method}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Risk'>
                  <span {{tooltip item.Risk}}>
                    {{item.Risk}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Issues'>
                  <span {{tooltip item.Issues}}>
                    {{item.Issues}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-PII'>
                  {{#if (eq item.PII.length 0)}}
                    --
                  {{/if}}
                  <span class='po-table-cell-child-PII' {{tooltip item.PII}}>
                    {{#each item.PII as |piiItem|}}
                      {{#if (eq piiItem 'EMAIL')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><path
                              fill='currentColor'
                              fill-rule='evenodd'
                              d='M0 3.25A2.25 2.25 0 012.25 1h11.5A2.25 2.25 0 0116 3.25v9.5A2.25 2.25 0 0113.75 15H2.25A2.25 2.25 0 010 12.75v-9.5zm2.25-.75a.75.75 0 00-.748.69L8 8.297l6.498-5.105a.75.75 0 00-.748-.691H2.25zm-.75 9.885V5.097l3.865 3.037L1.5 12.385zM2.514 13.5h10.972L9.452 9.063l-.989.777a.75.75 0 01-.926 0l-.99-.777L2.515 13.5zm8.12-5.366l3.866 4.251V5.097l-3.865 3.037z'
                              clip-rule='evenodd'
                            ></path></svg>
                        </span>
                      {{else if (eq piiItem 'PASSWORD')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor' fill-rule='evenodd' clip-rule='evenodd'><path
                                d='M9.16 3.657A2.236 2.236 0 0110.752 3a2.248 2.248 0 11-2.078 3.11l-.001-.002a2.243 2.243 0 01.489-2.451zm1.06 1.061a.737.737 0 01.815-.16.748.748 0 01-.284 1.44.748.748 0 01-.532-1.278l.001-.002z'
                              ></path><path
                                d='M10.354 0a5.68 5.68 0 00-4.906 2.846 5.68 5.68 0 00-.466 4.555L.22 12.162a.75.75 0 00-.22.53v2.558c0 .414.336.75.75.75h2.547a.75.75 0 00.53-.22l.655-.655a1.072 1.072 0 00.311-.784v-.64h.548c.31 0 .618-.123.843-.355l.008-.008c.204-.216.324-.498.33-.801v-.556h.676c.288 0 .566-.117.767-.327l.638-.637a5.664 5.664 0 004.55-.468 5.683 5.683 0 002.798-4.152v-.001a5.68 5.68 0 00-1.602-4.742A5.619 5.619 0 0010.354 0zm-.548 1.536a4.12 4.12 0 013.482 1.178 4.18 4.18 0 011.176 3.483 4.183 4.183 0 01-2.054 3.05 4.163 4.163 0 01-3.671.221.75.75 0 00-.143-.043l-.023-.005a.806.806 0 00-.714.219l-.842.842H5.973a.951.951 0 00-.95.951v.768h-.779a.951.951 0 00-.95.952v1.04l-.308.308H1.5v-1.497L6.355 8.15c.22-.22.311-.567.174-.888a4.178 4.178 0 01.221-3.67 4.18 4.18 0 013.053-2.054h.003z'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'DATE_TIME')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M8.5 3.75a.75.75 0 00-1.5 0V8c0 .284.16.544.415.67l2.5 1.25a.75.75 0 10.67-1.34L8.5 7.535V3.75z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'NAME')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                fill-rule='evenodd'
                                d='M8 1a4 4 0 100 8 4 4 0 000-8zM5.5 5a2.5 2.5 0 115 0 2.5 2.5 0 01-5 0z'
                                clip-rule='evenodd'
                              ></path><path
                                d='M5.25 10a3.75 3.75 0 00-3.75 3.75v.5a.75.75 0 001.5 0v-.5a2.25 2.25 0 012.25-2.25h5.5A2.25 2.25 0 0113 13.75v.5a.75.75 0 001.5 0v-.5A3.75 3.75 0 0010.75 10h-5.5z'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'URL')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z'
                              ></path><path
                                d='M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'CREDIT_CARD')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M3.75 9a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5h-1.5z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M0 4.25A2.25 2.25 0 012.25 2h11.5A2.25 2.25 0 0116 4.25v7.5A2.25 2.25 0 0113.75 14H2.25A2.25 2.25 0 010 11.75v-7.5zm14.5 0V5h-13v-.75a.75.75 0 01.75-.75h11.5a.75.75 0 01.75.75zm0 2.75h-13v4.75c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75V7z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'CREDIT_DEBIT_NUMBER')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M3.75 9a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5h-1.5z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M0 4.25A2.25 2.25 0 012.25 2h11.5A2.25 2.25 0 0116 4.25v7.5A2.25 2.25 0 0113.75 14H2.25A2.25 2.25 0 010 11.75v-7.5zm14.5 0V5h-13v-.75a.75.75 0 01.75-.75h11.5a.75.75 0 01.75.75zm0 2.75h-13v4.75c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75V7z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'CRYPTO')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><path
                              fill='currentColor'
                              fill-rule='evenodd'
                              d='M8.5.75a.75.75 0 00-1.5 0V2h-.594c-.9 0-1.766.353-2.405.985A3.36 3.36 0 003 5.375a3.36 3.36 0 001 2.39c.64.632 1.506.985 2.406.985H7v3.75H4.25a.75.75 0 000 1.5H7v1.25a.75.75 0 001.5 0V14h1.094c.9 0 1.766-.353 2.405-.985A3.36 3.36 0 0013 10.625a3.36 3.36 0 00-1-2.39 3.422 3.422 0 00-2.406-.985H8.5V3.5h3.25a.75.75 0 000-1.5H8.5V.75zM7 3.5h-.594c-.508 0-.994.2-1.35.552A1.86 1.86 0 004.5 5.375c0 .494.199.97.555 1.323.357.352.843.552 1.351.552H7V3.5zm1.5 5.25v3.75h1.094c.508 0 .994-.2 1.35-.552a1.86 1.86 0 00.556-1.323c0-.494-.199-.97-.555-1.323a1.922 1.922 0 00-1.351-.552H8.5z'
                              clip-rule='evenodd'
                            ></path></svg>
                        </span>
                      {{else if (eq piiItem 'EMAIL_ADDRESS')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><path
                              fill='currentColor'
                              fill-rule='evenodd'
                              d='M0 3.25A2.25 2.25 0 012.25 1h11.5A2.25 2.25 0 0116 3.25v9.5A2.25 2.25 0 0113.75 15H2.25A2.25 2.25 0 010 12.75v-9.5zm2.25-.75a.75.75 0 00-.748.69L8 8.297l6.498-5.105a.75.75 0 00-.748-.691H2.25zm-.75 9.885V5.097l3.865 3.037L1.5 12.385zM2.514 13.5h10.972L9.452 9.063l-.989.777a.75.75 0 01-.926 0l-.99-.777L2.515 13.5zm8.12-5.366l3.866 4.251V5.097l-3.865 3.037z'
                              clip-rule='evenodd'
                            ></path></svg>
                        </span>
                      {{else if (eq piiItem 'IP_ADDRESS')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><path
                              fill='currentColor'
                              fill-rule='evenodd'
                              d='M0 7.75A3 3 0 015.905 7h4.19a3.001 3.001 0 110 1.5h-4.19A3.001 3.001 0 010 7.75zm3-1.5a1.5 1.5 0 100 3 1.5 1.5 0 000-3zm10 0a1.5 1.5 0 100 3 1.5 1.5 0 000-3z'
                              clip-rule='evenodd'
                            ></path></svg>
                        </span>
                      {{else if (eq piiItem 'LOCATION')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor' fill-rule='evenodd' clip-rule='evenodd'><path
                                d='M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM7 7a1 1 0 112 0 1 1 0 01-2 0z'
                              ></path><path
                                d='M8 0C4.138 0 1 3.114 1 6.964a6.927 6.927 0 002.085 4.957l4.42 3.892a.75.75 0 00.99 0l4.42-3.892A6.927 6.927 0 0015 6.964C15 3.114 11.862 0 8 0zM2.5 6.964C2.5 3.95 4.958 1.5 8 1.5s5.5 2.45 5.5 5.464c0 1.5-.607 2.858-1.594 3.847L8 14.251l-3.906-3.44A5.427 5.427 0 012.5 6.964z'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'PERSON')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                fill-rule='evenodd'
                                d='M8 1a4 4 0 100 8 4 4 0 000-8zM5.5 5a2.5 2.5 0 115 0 2.5 2.5 0 01-5 0z'
                                clip-rule='evenodd'
                              ></path><path
                                d='M5.25 10a3.75 3.75 0 00-3.75 3.75v.5a.75.75 0 001.5 0v-.5a2.25 2.25 0 012.25-2.25h5.5A2.25 2.25 0 0113 13.75v.5a.75.75 0 001.5 0v-.5A3.75 3.75 0 0010.75 10h-5.5z'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'PHONE_NUMBER')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M8 12a1 1 0 100 2h.007a1 1 0 100-2H8z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M4.25 0A2.25 2.25 0 002 2.25v11.5A2.25 2.25 0 004.25 16h7.5A2.25 2.25 0 0014 13.75V2.25A2.25 2.25 0 0011.75 0h-7.5zM3.5 2.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v11.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75V2.25z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'US_BANK_NUMBER')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M5.187 10.482A2.324 2.324 0 016.625 10h2.75c.515 0 1.034.16 1.438.482.41.325.687.807.687 1.359v.409a.75.75 0 01-1.5 0v-.41c0-.026-.012-.098-.119-.183a.828.828 0 00-.506-.157h-2.75a.828.828 0 00-.506.157c-.107.085-.119.157-.119.184v.409a.75.75 0 01-1.5 0v-.41c0-.55.277-1.033.687-1.358z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM7 7a1 1 0 112 0 1 1 0 01-2 0z'
                                clip-rule='evenodd'
                              ></path><path
                                fill-rule='evenodd'
                                d='M5.25 0C4.56 0 4 .56 4 1.25V2H2.25A2.25 2.25 0 000 4.25v8.5A2.25 2.25 0 002.25 15h11.5A2.25 2.25 0 0016 12.75v-8.5A2.25 2.25 0 0013.75 2H12v-.75C12 .56 11.44 0 10.75 0h-5.5zm6.5 3.5c-.228.304-.591.5-1 .5h-5.5c-.409 0-.772-.196-1-.5h-2a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-8.5a.75.75 0 00-.75-.75h-2zm-1.25-1h-5v-1h5v1z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'US_DRIVER_LICENSE')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M5.187 10.482A2.324 2.324 0 016.625 10h2.75c.515 0 1.034.16 1.438.482.41.325.687.807.687 1.359v.409a.75.75 0 01-1.5 0v-.41c0-.026-.012-.098-.119-.183a.828.828 0 00-.506-.157h-2.75a.828.828 0 00-.506.157c-.107.085-.119.157-.119.184v.409a.75.75 0 01-1.5 0v-.41c0-.55.277-1.033.687-1.358z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM7 7a1 1 0 112 0 1 1 0 01-2 0z'
                                clip-rule='evenodd'
                              ></path><path
                                fill-rule='evenodd'
                                d='M5.25 0C4.56 0 4 .56 4 1.25V2H2.25A2.25 2.25 0 000 4.25v8.5A2.25 2.25 0 002.25 15h11.5A2.25 2.25 0 0016 12.75v-8.5A2.25 2.25 0 0013.75 2H12v-.75C12 .56 11.44 0 10.75 0h-5.5zm6.5 3.5c-.228.304-.591.5-1 .5h-5.5c-.409 0-.772-.196-1-.5h-2a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-8.5a.75.75 0 00-.75-.75h-2zm-1.25-1h-5v-1h5v1z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'US_PASSPORT')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M5.187 10.482A2.324 2.324 0 016.625 10h2.75c.515 0 1.034.16 1.438.482.41.325.687.807.687 1.359v.409a.75.75 0 01-1.5 0v-.41c0-.026-.012-.098-.119-.183a.828.828 0 00-.506-.157h-2.75a.828.828 0 00-.506.157c-.107.085-.119.157-.119.184v.409a.75.75 0 01-1.5 0v-.41c0-.55.277-1.033.687-1.358z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM7 7a1 1 0 112 0 1 1 0 01-2 0z'
                                clip-rule='evenodd'
                              ></path><path
                                fill-rule='evenodd'
                                d='M5.25 0C4.56 0 4 .56 4 1.25V2H2.25A2.25 2.25 0 000 4.25v8.5A2.25 2.25 0 002.25 15h11.5A2.25 2.25 0 0016 12.75v-8.5A2.25 2.25 0 0013.75 2H12v-.75C12 .56 11.44 0 10.75 0h-5.5zm6.5 3.5c-.228.304-.591.5-1 .5h-5.5c-.409 0-.772-.196-1-.5h-2a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-8.5a.75.75 0 00-.75-.75h-2zm-1.25-1h-5v-1h5v1z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'IT_DRIVER_LICENSE')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M5.187 10.482A2.324 2.324 0 016.625 10h2.75c.515 0 1.034.16 1.438.482.41.325.687.807.687 1.359v.409a.75.75 0 01-1.5 0v-.41c0-.026-.012-.098-.119-.183a.828.828 0 00-.506-.157h-2.75a.828.828 0 00-.506.157c-.107.085-.119.157-.119.184v.409a.75.75 0 01-1.5 0v-.41c0-.55.277-1.033.687-1.358z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM7 7a1 1 0 112 0 1 1 0 01-2 0z'
                                clip-rule='evenodd'
                              ></path><path
                                fill-rule='evenodd'
                                d='M5.25 0C4.56 0 4 .56 4 1.25V2H2.25A2.25 2.25 0 000 4.25v8.5A2.25 2.25 0 002.25 15h11.5A2.25 2.25 0 0016 12.75v-8.5A2.25 2.25 0 0013.75 2H12v-.75C12 .56 11.44 0 10.75 0h-5.5zm6.5 3.5c-.228.304-.591.5-1 .5h-5.5c-.409 0-.772-.196-1-.5h-2a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-8.5a.75.75 0 00-.75-.75h-2zm-1.25-1h-5v-1h5v1z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'IT_IDENTITY_CARD')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M5.187 10.482A2.324 2.324 0 016.625 10h2.75c.515 0 1.034.16 1.438.482.41.325.687.807.687 1.359v.409a.75.75 0 01-1.5 0v-.41c0-.026-.012-.098-.119-.183a.828.828 0 00-.506-.157h-2.75a.828.828 0 00-.506.157c-.107.085-.119.157-.119.184v.409a.75.75 0 01-1.5 0v-.41c0-.55.277-1.033.687-1.358z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM7 7a1 1 0 112 0 1 1 0 01-2 0z'
                                clip-rule='evenodd'
                              ></path><path
                                fill-rule='evenodd'
                                d='M5.25 0C4.56 0 4 .56 4 1.25V2H2.25A2.25 2.25 0 000 4.25v8.5A2.25 2.25 0 002.25 15h11.5A2.25 2.25 0 0016 12.75v-8.5A2.25 2.25 0 0013.75 2H12v-.75C12 .56 11.44 0 10.75 0h-5.5zm6.5 3.5c-.228.304-.591.5-1 .5h-5.5c-.409 0-.772-.196-1-.5h-2a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-8.5a.75.75 0 00-.75-.75h-2zm-1.25-1h-5v-1h5v1z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'IT_PASSPORT')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                d='M5.187 10.482A2.324 2.324 0 016.625 10h2.75c.515 0 1.034.16 1.438.482.41.325.687.807.687 1.359v.409a.75.75 0 01-1.5 0v-.41c0-.026-.012-.098-.119-.183a.828.828 0 00-.506-.157h-2.75a.828.828 0 00-.506.157c-.107.085-.119.157-.119.184v.409a.75.75 0 01-1.5 0v-.41c0-.55.277-1.033.687-1.358z'
                              ></path><path
                                fill-rule='evenodd'
                                d='M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM7 7a1 1 0 112 0 1 1 0 01-2 0z'
                                clip-rule='evenodd'
                              ></path><path
                                fill-rule='evenodd'
                                d='M5.25 0C4.56 0 4 .56 4 1.25V2H2.25A2.25 2.25 0 000 4.25v8.5A2.25 2.25 0 002.25 15h11.5A2.25 2.25 0 0016 12.75v-8.5A2.25 2.25 0 0013.75 2H12v-.75C12 .56 11.44 0 10.75 0h-5.5zm6.5 3.5c-.228.304-.591.5-1 .5h-5.5c-.409 0-.772-.196-1-.5h-2a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-8.5a.75.75 0 00-.75-.75h-2zm-1.25-1h-5v-1h5v1z'
                                clip-rule='evenodd'
                              ></path></g></svg>
                        </span>
                      {{else if (eq piiItem 'USERNAME')}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                fill-rule='evenodd'
                                d='M8 1a4 4 0 100 8 4 4 0 000-8zM5.5 5a2.5 2.5 0 115 0 2.5 2.5 0 01-5 0z'
                                clip-rule='evenodd'
                              ></path><path
                                d='M5.25 10a3.75 3.75 0 00-3.75 3.75v.5a.75.75 0 001.5 0v-.5a2.25 2.25 0 012.25-2.25h5.5A2.25 2.25 0 0113 13.75v.5a.75.75 0 001.5 0v-.5A3.75 3.75 0 0010.75 10h-5.5z'
                              ></path></g></svg>
                        </span>
                      {{else}}
                        <span>
                          <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16'
                            fill='none'
                            viewBox='0 0 16 16'
                          ><g fill='currentColor'><path
                                fill-rule='evenodd'
                                d='M8 1a4 4 0 100 8 4 4 0 000-8zM5.5 5a2.5 2.5 0 115 0 2.5 2.5 0 01-5 0z'
                                clip-rule='evenodd'
                              ></path><path
                                d='M5.25 10a3.75 3.75 0 00-3.75 3.75v.5a.75.75 0 001.5 0v-.5a2.25 2.25 0 012.25-2.25h5.5A2.25 2.25 0 0113 13.75v.5a.75.75 0 001.5 0v-.5A3.75 3.75 0 0010.75 10h-5.5z'
                              ></path></g></svg>
                        </span>
                      {{/if}}
                    {{/each}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Auth'>
                  <span {{tooltip item.Auth}} class='po-table-cell-child-Auth'>
                    {{#if (eq item.Auth 'unknown')}}
                      <span class='red-color'>
                        <svg
                          xmlns='http://www.w3.org/2000/svg'
                          width='16'
                          height='16'
                          fill='none'
                          viewBox='0 0 16 16'
                        ><path
                            fill='currentColor'
                            fill-rule='evenodd'
                            d='M8 .25a7.75 7.75 0 100 15.5A7.75 7.75 0 008 .25zm2.72 3.97a.75.75 0 111.06 1.06L9.06 8l2.72 2.72a.75.75 0 11-1.06 1.06L8 9.06l-2.72 2.72a.75.75 0 01-1.06-1.06L6.94 8 4.22 5.28a.75.75 0 011.06-1.06L8 6.94l2.72-2.72z'
                            clip-rule='evenodd'
                          ></path></svg>
                      </span>
                    {{else}}
                      <span class='green-color'>
                        <svg
                          xmlns='http://www.w3.org/2000/svg'
                          width='16'
                          height='16'
                          fill='none'
                          viewBox='0 0 16 16'
                        ><path
                            fill='currentColor'
                            fill-rule='evenodd'
                            d='M8 0a8 8 0 100 16A8 8 0 008 0zm2.72 5.22a.75.75 0 111.06 1.06l-4.5 4.5a.75.75 0 01-1.06 0l-2-2a.75.75 0 011.06-1.06l1.47 1.47 3.97-3.97z'
                            clip-rule='evenodd'
                          ></path></svg>
                      </span>
                    {{/if}}
                    {{item.Auth}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Internet'>
                  {{#if item.Internet}}
                    <span {{tooltip 'Internet Facing'}} class='green-color'>
                      <svg
                        xmlns='http://www.w3.org/2000/svg'
                        width='16'
                        height='16'
                        fill='none'
                        viewBox='0 0 16 16'
                      ><path
                          fill='currentColor'
                          fill-rule='evenodd'
                          d='M8 0a8 8 0 100 16A8 8 0 008 0zm2.72 5.22a.75.75 0 111.06 1.06l-4.5 4.5a.75.75 0 01-1.06 0l-2-2a.75.75 0 011.06-1.06l1.47 1.47 3.97-3.97z'
                          clip-rule='evenodd'
                        ></path></svg>
                    </span>
                  {{/if}}
                  {{#unless item.Internet}}
                    <span {{tooltip 'Internal Facing'}} class='red-color'>
                      <svg
                        xmlns='http://www.w3.org/2000/svg'
                        width='16'
                        height='16'
                        fill='none'
                        viewBox='0 0 16 16'
                      ><path
                          fill='currentColor'
                          fill-rule='evenodd'
                          d='M8 .25a7.75 7.75 0 100 15.5A7.75 7.75 0 008 .25zm2.72 3.97a.75.75 0 111.06 1.06L9.06 8l2.72 2.72a.75.75 0 11-1.06 1.06L8 9.06l-2.72 2.72a.75.75 0 01-1.06-1.06L6.94 8 4.22 5.28a.75.75 0 011.06-1.06L8 6.94l2.72-2.72z'
                          clip-rule='evenodd'
                        ></path></svg>
                    </span>
                  {{/unless}}
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Traffic'>
                  <span {{tooltip item.Traffic}}>
                    {{item.Traffic}}
                  </span>
                </div>
              </B.Td>
              <B.Td class='po-table-cell'>
                <div class='po-table-cell-child-Drifted'>
                  {{#if (eq item.Drifted true)}}
                    <span class='red-color' {{tooltip 'Drift has occured'}}>
                      <svg
                        xmlns='http://www.w3.org/2000/svg'
                        width='16'
                        height='16'
                        fill='none'
                        viewBox='0 0 16 16'
                      ><path
                          fill='currentColor'
                          fill-rule='evenodd'
                          d='M8 1a2.143 2.143 0 00-1.827 1.024l-5.88 9.768a2.125 2.125 0 00.762 2.915c.322.188.687.289 1.06.293h11.77a2.143 2.143 0 001.834-1.074 2.126 2.126 0 00-.006-2.124L9.829 2.028A2.149 2.149 0 008 1zM7 11a1 1 0 011-1h.007a1 1 0 110 2H8a1 1 0 01-1-1zm1.75-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z'
                          clip-rule='evenodd'
                        ></path></svg>
                    </span>
                  {{else}}
                    --
                  {{/if}}
                </div>
              </B.Td>
            </B.Tr>
          {{/each}}
        </:body>
      </Hds::Table>
    {{else if error}}
      <div class='po-paper-container'>
        <span class='po-error-icon'>
          <FlightIcon @name='alert-circle' />
        </span>
        An error was encountered.
      </div>
    {{else}}
      <Consul::Loader />
    {{/if}}

  {{else}}
    <div class='po-centerd-button-container'>
      <div class='po-display-flex'>
        <p class='po-login-message'>
          We are delighted to invite you to experience our cutting-edge API Insights. Please log in
          using your
          <a href='https://protectonce.com/' target='_blank'>
            ProtectOnce
          </a>
          email and password!
        </p>
        <Hds::Button @text='Login to ProtectOnce' @color='secondary' {{action 'showLoginModal'}} />
      </div>
    </div>

    {{#if openLogin}}
      <Hds::Modal id='basic-modal' @onClose={{action 'closeModal'}} as |M|>
        <M.Header>
          Login to ProtectOnce
        </M.Header>
        <M.Body>
          <div class='po-login-modal-body'>
            <Hds::Form::TextInput::Field
              {{on 'change' setEmail}}
              @type='email'
              @isRequired={{true}}
              @value=''
              as |F|
            >
              <F.Label>Email</F.Label>
            </Hds::Form::TextInput::Field>
            <br />
            <Hds::Form::TextInput::Field
              {{on 'change' setPassword}}
              @type='password'
              @isRequired={{true}}
              @value=''
              @isInvalid={{false}}
              as |F|
            >
              <F.Label>Password</F.Label>
              {{! <F.Error as |E|>
              <E.Message>Length should be at least 12 characters</E.Message>
              <E.Message>Must contain at least a special character</E.Message>
            </F.Error> }}
            </Hds::Form::TextInput::Field>
          </div>
        </M.Body>
        <M.Footer as |F|>
          <div class='po-login-modal-buttons'>
            <Hds::Button type='button' @color='secondary' @text='Sign-Up' {{action 'signUp'}} />
            <Hds::Button type='button' @text='Login' {{action 'initiateLogin'}} />
          </div>
        </M.Footer>
      </Hds::Modal>
    {{/if}}
  {{/if}}

</div>